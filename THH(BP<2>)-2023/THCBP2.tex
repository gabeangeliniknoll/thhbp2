% root file is THHBP2BP1.tex

\section{Topological Hochschild cohomology of $BP\langle 2\rangle$}
We will write $THH_S^*(BP\langle 2\rangle ; M)$ for topological Hochschild cohomology of $BP\langle 2\rangle$ with coefficients in a $\tBP{2}\wedge \tBP{2}^{\op}$-module $M$, which is defined to be
\[ THH_S^*(BP\langle 2\rangle;M) := \pi_* \left ( F_{BP\langle 2\rangle^e} (BP\langle 2\rangle,M) \right )  \]
where $BP\langle 2\rangle^e:=BP\langle 2\rangle\wedge BP\langle 2\rangle^{\op}$. 
We recall that there is a universal coefficient spectral sequence (UCSS) computing the homotopy groups of $F_{BP\langle 2\rangle^e} (BP\langle 2\rangle,BP\langle 2\rangle)$ 
\[ Ext_{ \pi_*(BP\langle 2\rangle^e)}^{*,*} (BP\langle 2\rangle_*,BP\langle 2\rangle_*) \Rightarrow THC^*(BP\langle 2\rangle), \]
but this is usually not computable. With coefficients in $H\mathbb{F}_p$, however, we can compute $THC^*(\B;H\F_p)$ by a different means. First, note that 
\[ THH_*(\B; H\F_p)\cong E(\lambda_1,\lambda_2,\lambda_3)\otimes P(\mu_3)\]
 is a finite type graded $\mathbb{F}_p$-algebra and $THH(BP\langle 2\rangle; H\F_p)$ is an $H\F_p$-algebra. Given a map of commutative ring spectra $f\co R\to S$ there is an associated adjunction $f_!\dashv f^*$ where $f_!(M)=M\wedge_RS$ is extension of scalars and $f^*$ is restriction. By the adjunction $ f_! \dashv f^*$ associated to the map of commutative ring spectra 
$f\co \tBP{2}^e\to H\mathbb{F}_p$, there is an equivalence
\[ F_{H\F_p} (THH(BP\langle 2 \rangle ; H\F_p ) , H\F_p ) \simeq F_{\tBP{2}^e}(BP\langle 2 \rangle , H\mathbb{F}_p). \] 
The UCSS 
\[ \Ext_{\F_p}^{*,*}(\pi_*(\THH(\B;H\F_p)),\F_p) \Rightarrow \THH_S^*(\B;H\F_p)\]
collapses and 
\begin{equation}\label{THCHFp} \THH_S^*(BP\langle 2 \rangle , H\mathbb{F}_p)\cong \Hom_{\mathbb{F}_p}(\THH_*(BP\langle 2 \rangle;H\mathbb{F}_p),\mathbb{F}_p) \end{equation}
where 
\[\Hom_{\mathbb{F}_p}(THH_*(BP\langle 2 \rangle;H\mathbb{F}_p),\mathbb{F}_p) \cong E(x_1,x_2,x_3)\otimes \Gamma(c_1) \]
and $|x_i|=2p^i-1$ and $|c_3|=2p^3$. The classes $x_i$ are dual to $\lambda_i$ and the class $c_{i}=\gamma_i(c_1)$ is dual to $\mu_3^i$, adopting the notation conventions of \cite{AHL}.  In fact, many of the results of this section are straighforward generalizations of those in \cite{AHL}, but we include all the details we need for completeness. 

\subsection{Relative topological Hochschild cohomology of $\B$}
Recall that there is an isomorphism 
\[ H_*(MU)\cong P(b_k \mid k\ge 1) \]
and the map 
\[ H_*(MU) \to  H_*(BP)\cong P(\bxi_k |k\ge 1) \]
sends $b_{j}$ to $\bar{\xi}_k$ for $k\ge 1$ if $j=p^k-1$ and zero otherwise at $p=3$. 

\begin{lem}
There is an isomorphism of rings 
\[ \pi_*\left (H\F_p\wedge_{MU}\B \right ) \cong  E(\tau_3,\tau_4,\ldots )\otimes E(\delta b_i \mid i\not \equiv 0 \pmod{p^k-1}, k\ge 1) \]
and the map from $H_*(\B$) is given by the canonical quotient 
\[ H_*(\B) \cong P(\xi_1,\xi_2,\ldots ) \otimes E(\tau_3,\tau_4,\ldots ) \to E(\tau_3,\tau_4,\ldots )  \]
tensored with the unit map
\[ \mathbb{F}_p \to E(\delta b_i \mid i\not \equiv 0 \pmod{p^k-1}, k\ge 1).\]
Here $|\delta b_i|=1+|b_i|$.
\end{lem}
\begin{proof}
First note that there is an equivalence of commutative $H\mathbb{F}_p$-algebras
\[H\F_p\wedge_{MU}\B \simeq H\F_p\wedge_{H\F_p\wedge MU}H\F_p\wedge \B.\]
The K\"unneth spectral sequence has input 
\[ 
\begin{array}{rcl}
\Tor_*^{H_*MU}(\F_p, H_*\B)&\cong& \Tor_*^{P(\bar{\xi_1},\bar{\xi}_2,\ldots )}(\F_p, H_*\B)\otimes \Tor^{P(  b_i \mid  i\not\equiv 0\mod (p^k-1), k\ge 1)}(\F_p,\F_p)\\
&=& E(\tau_3,\tau_4,\ldots )\otimes E( \delta b_i \mid i\not \equiv 0 \pmod{p^k-1}, k\ge 1)
\end{array}
\]
and since $MU$ is a commutative ring spectrum, it is a multiplicative spectral sequence.
The K\"unneth spectral sequence collapses because all the algebra generators are in filtration $0,1$ and the differentials shift filtration by at least $2$. By factoring the relevant map as  
\[H_*(\B ) \to  \pi_*( H\F_p\wedge_{BP}\B)\to \pi_*(H\F_p\wedge_{MU}\B ) \]
and computing $\pi_*(H\F_p\wedge_{BP}\B)\cong E(\tau_3,\tau_4,\ldots )$ by the same argument, we see that the map is the composite of the canonical quotient 
with the identity tensored with the unit map 
%\[\F_p\to  E(\sigma b_i \mid i\not \equiv 0 \pmod{p^k-1}, k\ge 1)\] 
as desired. 
\end{proof}
Recall from Lemma 2.4 \cite{AHL} that when $R\to Q$ is a map of $E$-algebras and $M$ is a $Q\wedge_E R^{\op}$-module, with an $R\wedge_E R^{\op}$-module structure by pullback, then 
\[ THH_E(R;M)\simeq F_{Q\wedge_E R^{\text{op}}} (Q,M). \]
\begin{lem} The following hold:
\begin{enumerate}
\item There is an isomorphism of rings 
\[ THH_{MU}^*(\B;H\F_p)\cong P(e_i \mid i\ge 3 )\otimes P(g_i \mid i\not \equiv 0 \pmod{p^k-1}, k\ge 1)\]
where $|e_i|=|\tau_i|+1$ and $|g_i|=2i+2$.
\item Consequently, $THC_{MU}^*(\B)$ is isomorphic to 
\[ \B_*(e_i \mid i\ge 3 )\otimes P(g_i \mid i\not \equiv 0 \pmod{p^k-1}, k\ge 1).\]
\item The map 
\[ THH_{MU}^*(\B) \to THH_{MU}^*(\B;H\F_p)\]
is induced by the quotient by $(p,v_1,v_2)$. 
\item The map 
\[ THH_{MU}^*(\B;H\F_p) \to THH_S^*(\B;H\F_p) \]
sends $e_i$ to $c_{p^{i-3}}$ for $i\ge 3$. 
\item Consequently, the elements 
$c_{p^{i-3}}$ pull back to elements in $THC^*(\B)$.
\end{enumerate}
\end{lem}
\begin{proof}
From the setup before this lemma, we may consider the UCSS computing 
\[ THH_E(R;M)\simeq F_{Q\wedge_E R^{\text{op}}} (Q,M)\]
with input 
\[ \Ext_{\pi_*(Q\wedge_E R^{\text{op}})}^{*,*}(Q_*,M_*. )\]
When $E=MU$, $R=\B$ and $M=Q=H\F_p$. The UCSS computing 
\[THH_{MU}^*(\B;H\F_p)\]
has input 
\[ \Ext_{\pi_*H\F_p\wedge_{MU}\B }^* (\F_p, \F_p)\cong P(e_i \mid i\ge 3 )\otimes P(g_i \mid i\not \equiv 0 \pmod{p^k-1}, k\ge 1) \]
where $|e_i|=2p^i$ and $|g_i|=2i+2$.
Note that by Tor duality and Koszul duality 
\[\Tor_*^{P(b)}(\F_p,\F_p)\cong E(\delta b_i)\] 
where $|\delta b_i|=|b_i|+1$ and 
\[\Ext^*_{E(\delta b_i)}(\F_p,\F_p)\cong P(g_i)\] where $|g_i|=|b_i|+2$ for all $i$. Since all elements are in even total degree there is no room for differentials and the spectral sequence  collapses. This proves the first statement. 

There are three Bockstein spectral sequences to go from $THH_{MU}^*(\B;H\F_p)$ to $THH_{MU}^*(\B)$, but in each case all elements are in even columns and the spectral sequences collapse since there is an Adams style differential convention. This proves the second statement and the third statement. 

Now, by the commutative diagram
\[
\xymatrix{
THH^*_{MU}(\B) \ar[r] \ar[d]& THH^*_{MU}(\B; H\F_p) \ar[d]  \\
THH_S^*(\B) \ar[r] & THH_S^*(\B; H\F_p) }
\]
the fifth statement follows from the fourth statement. It therefore remains to show that the map 
\[ THH_{MU}^*(\B;H\F_p) \to THH_S^*(\B;H\F_p) \]
sends $e_i$ to $c_{p^{i-3}}$ for $i\ge 3$. Recall the map  $H_*(\B) \to \pi_*\left ( H\F_p\wedge_{MU}\B \right )$ sends $\tau_i$ to $\tau_i$ for $i\ge  3$. Tracing this through the induced map of universal coefficient spectral sequences produces the desired result. 
\end{proof}
\subsection{Computation of the cap product}
Next we determine the $p$-torsion of $c_k$ in 
\[THH_S^*(\B;H\Z_{(p)}).\] 
\begin{lem}
There is an isomorphism of graded $\mathbb{Z}_{(p)}$-modules
\[ THH_S^*(\B;H\Z_{(p)})\cong E_{\Z_{(p)}}(x_1,x_2)\otimes \Gamma_{\Z_{(p)}}(c_1)/(pc_1).\]
\end{lem}
\begin{proof}
In general, if $R$ is a commutative ring spectrum and $H\Z_{(p)}$ is a commutative $R$-algebra, then $\THH_*^S(R,H\Z_{(p)})$ is a $\Z_{(p)}$ Hopf-algebra spectrum whenever the $\mathbb{Z}_{(p)}$-modules $THH_k(R;H\Z_{(p)})$ are a finitely generated for all $k$. By Corollary \ref{BHZ}, $\THH_*^S(\B;H\Z_{(p)})$ is a finitely generated $\Z_{(p)}$-algebra in each degree. There is an isomorphism 
\[ \Ext_{\mathbb{Z}_{(p)}}^*( \THH_*^S(\B;H\Z_{(p)});\Z_{(p)}) \cong \THH_S^*(\B;H\Z_{(p)})\]  
since the UCSS collapses to the zero and one line because $\Z_{(p)}$ is a PID and there is no room for extensions. Consequently, $\THH_S^*(\B;H\Z_{(p)})$ is finitely generated in each degree. 
Since $THH_S^*(\B;H\Z_{(p)})$ and it is also finitely generated in each degree and the Bockstein spectral sequence 
\[ THH_S^*(\B;H\F_p)[v_0]\Rightarrow THH_S^*(\B;H\Z_{(p)})_p\]
converges. %Since multiplication by $p$ commutes with the coproduct this is a spectral sequence of Hopf algebras. 
In order for the isomorphism 
\[ \Ext_{\mathbb{Z}_{(p)}}^*( \THH_*^S(\B;H\Z_{(p)});\Z_{(p)}) \cong \THH_S^*(\B;H\Z_{(p)})\]  
to hold the differentials
\[ d_{i+1}(c_{p^{i}-1}x_3) \dot{=} v_0^{i+1}c_{p^i}\]
are forced for $i\ge 0$ where $c_0=1$ by convention. It is also clear from the isomorphism 
\[ \Ext_{\mathbb{Z}_{(p)}}^*( \THH_*^S(\B;H\Z_{(p)});\Z_{(p)}) \cong \THH_S^*(\B;H\Z_{(p)})\] 
that the additive extensions are as stated. 
\end{proof}
Recall that there is a cap product 
\[ THH_S^k(\B)\otimes THH^S_m(\B;H\Z_{(p)})\rightarrow THH^S_{m-k}(\B;H\Z_{(p)})\]
and we showed that the elements $c_k$ lift to elements in $THH_S^*(\B)$. 
\gabe{In \cite{AHL}, they claim that they lift to torsion free elements. Do we need this? Can we prove this here if we do?}

We now remark on two facts that will be useful for computing the cap product. 
\begin{lem}\label{lemma for cap product}
The cap product commutes with scalars so that 
\[ c_k \cap (\alpha \cdot x) = \alpha\cdot (c_k \cap x)\]
and the the cap product $c_k\cap -$ induces a map of Bockstein spectral sequences 
\[ 
	\xymatrix{ 
		THH_*^S(\B;H\F_p)[v_0] \ar[r]^{c_k\cap - } \ar@{=>}[d] & THH_*^S(\B;H\F_p)[v_0] \ar@{=>}[d] \\
		THH_*^S(\B;H\Z_{(p)}) \ar[r]^{c_k\cap -} & THH_*^S(\B;H\Z_{(p)})
		}
\]
which is compatible with the edge homomorphism 
\[ 
	\xymatrix{
		THH_*(\B;H\Z_{(p)}) \ar[d] \ar[r]^{c_k \cap -} &  THH_*(\B;H\Z_{(p)}) \ar[d]  \\
		THH_*(\B;H\F_p) \ar[r] & THH_*(\B;H\F_p) 
		}
\]
where the edge homomorphism in the Bockstein spectral sequence is simply the canonical quotient map given by reduction modulo $p$. 
\end{lem}
\begin{proof}
The fact that the cap product commutes with scalars is clear by construction. Since the cap product is defined by sending a $R\wedge R^{\op}$-linear map $f \colon R\to R$ to the map $M\wedge _{R\wedge R^{\op}} f$, it is clear that capping with class induces a map of Bockstein spectral sequences and the last fact is a direct consequence. 
\end{proof}
	
\begin{cor}
For $k < n$, the cap product satisfies the following formulae
\[c_{k}\cap c_n^{(m)} \dot{=} p^{\gamma(n,k)}
c_{n-k}^{(m)}\]
\[c_{k}\cap d_n^{(m)} \dot{=} p^{\gamma(n,k)} d_{n-k}^{(m)}\]
for $1\le m \le 2$ where $\gamma(n,k)=\min\{ \nu_p(n)-\nu_p(n-k),0\}$. 
\end{cor}

\begin{proof}
We showed that the classes $c_n^{(k)}$ and $d_n^{(k)}$ in $THH_*(\B;H\Z_{(p)})$ are each $p^{\nu_p(n)+1}$-torsion for $k=1,2$. We will just prove the case for $c_n^{(1)}$ since the other cases are exactly the same. Since $c_n^{(1)}$ maps to $\lambda_3\mu_3^{n-1}$ in $THH_*(\B;H\F_p)$ via the edge homomorphism and $c_k\cap \lambda_3\mu_3^{n-1}=\lambda_3\mu_3^{n-k-1}$ we see that observe that 
\[ c_{k}\cap c_n^{(1)}=\beta \cdot c_{n-k}^{(1)}\]
 for some $\beta \in \Z_{(p)}$. 

By Lemma \ref{lemma for cap product}, it is clear that 
\[ c_{k}\cap ( p^{\nu_p(n)+1} \cdot c_n^{(1)})=p^{\nu_p(n)+1}\cdot (c_k \cap c_n^{1})=0.\]

Therefore, $p^{\nu_p(n)+1}\beta \cdot c_{n-k}^{(1)}=0$, 
\gabe{There is a problem here. How do we know $\beta$ itself isn't zero then?}
so since $p^{\nu_p(n-k)+1}c_{n-1}^{(1)}=0$, we know that $p^{\nu_p(n-k)+1}\cdot \beta \equiv 0 \mod p^{\nu_p(n)+1}$, so in other words $\beta \dot{=} p^{\gamma(n,k)}$ as desired. 
\end{proof}

\begin{comment}
Since $c_{p^k}$ is $p^{k+1}$ torsion in $THH_S^*(\B;H\Z_{(p)})$ we see that $p^kc_{p^k}\ne 0$. However, in the Adams spectral sequence for $THH_S^*(\B)$ these classes are torsion free. 
The cap product is also natural and therefore it commutes with Bockstein spectral sequence differentials.
\end{comment}